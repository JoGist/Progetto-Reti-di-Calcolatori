<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html class="container" lang="en">
  <head>
    <title>Search - VGDatabase</title>
    <script src=Rails.application.credentials.maps[:api_key]></script>
    <script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
    <script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->
  </head>
  <body class="visible">
    <aside class="sidebar normal">
      <nav>
        <ul class="sidebar__nav">
          <li>
            <a class="sidebar__nav__link_plain_img">
              <%= image_tag ('logo-normal.png') %>
            </a>
          </li>
          <li>
            <a class="sidebar__nav__link" data-method="get" href="<%= homepage_path %>">
              <i class="mdi mdi-home"></i>
              <span class="sidebar__nav__text">Homepage</span>
            </a>
          </li>
          <li>
            <a class="sidebar__nav__link" data-method="get" href="<%= collection_path %>">
              <i class="mdi mdi-library-movie"></i>
              <span class="sidebar__nav__text">Collection</span>
            </a>
          </li>
          <li>
            <a class="sidebar__nav__link" data-method="get" href="<%= selling_path %>">
              <i class="mdi mdi-shopping"></i>
              <span class="sidebar__nav__text">Selling</span>
            </a>
          </li>
          <li class="active">
            <a class="sidebar__nav__link_plain">
              <i class="mdi mdi-database-search"></i>
              <span class="sidebar__nav__text">Search</span>
            </a>
          </li>
          <li>
            <a class="sidebar__nav__link" data-method="get" href="<%= friends_path %>">
              <i class="mdi mdi-account-multiple"></i>
              <span class="sidebar__nav__text">Friends</span>
            </a>
          </li>
          <li>
            <a class="sidebar__nav__link" data-method="get" href="<%= myProfile_path %>">
              <%= image_tag (@user.avatar), class: "img3" %>
              <span class="sidebar__nav__text">My account</span>
            </a>
          </li>
          <li>
            <a class="sidebar__nav__link" data-method="delete" href="<%= login_path %>">
              <i class="mdi mdi-logout-variant"></i>
              <span class="sidebar__nav__text">Log out </span>
            </a>
          </li>
          <li>
            <a class="sidebar__nav__link" data-method="get" href="<%= contactUs_path %>">
              <i class="mdi mdi-information"></i>
              <span class="sidebar__nav__text">Contact us</span>
            </a>
          </li>
        </ul>
      </nav>
    </aside>
    <br/>
    <!--<h1>Games search</h1>-->
    <div class="s003">
      <%= form_tag :method => :get do %>
        <div class="inner-form">
          <div class="input-field first-wrap">
            <div class="btn-group inner">
              <buttonActive class="borderLeft">Games</buttonActive>
              <a class="left-4" data-method="get" href="<%= searchUser_path %>">Users</a>
            </div>
          </div>
          <div class="vl"></div>
          <div class="input-field second-wrap">
            <input id="search" name="game" placeholder="Type here to search..." type="text"></input>
          </div>
          <i class="mdi mdi-filter-variant searchBar"></i>
          <div class="input-field third-wrap">
            <button class="btn-search">
              <svg aria-hidden="true" class="svg-inline--fa fa-search fa-w-16" data-icon="search" data-prefix="fas" role="img" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                <path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z" fill="currentColor"></path>
              </svg>
            </button>
          </div>
        </div>
      <% end %>
    </div>
    <br>
    <div class="page-content extraPadding">
      <a class="new">
        <span>New</span>
        <%= image_tag ("marker.png"), class: "img4" %>
      </a>
      <a class="used">
        <span>Used</span>
        <%= image_tag ("marker_alt.png"), class: "img4" %>
      </a>
    <div id="map" style='width: 90%; height: 670px; margin-left: 5%; border: 3px solid #f26657;'></div>
      <script type='text/javascript'>
        handler = Gmaps.build('Google');
        handler.buildMap({ provider: {
        "center": { lat: 41.9028144, lng: 12.4963954 },
        "zoom": 12,
        "mapTypeControl": false,
        "streetViewControl" : false,
        styles: [
            {
              featureType: "administrative.land_parcel",
              stylers: [
                {
                  visibility: "off",
                },
              ],
            },
            {
              featureType: "administrative.neighborhood",
              stylers: [
                {
                  visibility: "off",
                },
              ],
            },
            {
              featureType: "poi",
              elementType: "labels.text",
              stylers: [
                {
                  visibility: "off",
                },
              ],
            },
            {
              featureType: "poi.business",
              stylers: [
                {
                  visibility: "off",
                },
              ],
            },
            {
              featureType: "road",
              elementType: "labels",
              stylers: [
                {
                  visibility: "off",
                },
              ],
            },
            {
              featureType: "road",
              elementType: "labels.icon",
              stylers: [
                {
                  visibility: "off",
                },
              ],
            },
            {
              featureType: "road.local",
              stylers: [
                {
                  visibility: "on",
                },
              ],
            },
            {
              featureType: "transit",
              stylers: [
                {
                  visibility: "off",
                },
              ],
            },
            {
              featureType: "water",
              elementType: "labels.text",
              stylers: [
                {
                  visibility: "off",
                },
              ],
            },
          ],
        }, 
        internal: {id: 'map'}}, function(){
          /*var circles = handler.addCircles(
            [{ lat: 41.923443, lng: 12.416874, radius: 1500 }],
            { strokeColor: '#f26657'}
          );*/
          markers = handler.addMarkers(<%=raw @hash.to_json %>); 
          markers = handler.addMarkers(<%=raw @hash1.to_json %>); 
          handler.bounds.extendWith();
          handler.fitMapToBounds();
        });
      </script>
    </div>
  </body>
  <br>
</html>


<!-- 
https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Markers

https://stackoverflow.com/questions/30988903/rails-4-gmaps4rails-how-to-include-a-link-to-a-show-view-in-marker-infowindo

https://stackoverflow.com/questions/21105142/gmaps4rails-populating-infowindow-with-multiple-values-from-an-array

https://stackoverflow.com/questions/42634667/rails-customizing-an-infowindow-using-gmaps4rails - geocoding example

https://apneadiving.github.io/ - Custom Builder

class CustomMarkerBuilder extends Gmaps.Google.Builders.Marker
  create_marker: ->
    options = _.extend @marker_options(), @rich_marker_options()
    @serviceObject = new RichMarker options

  rich_marker_options: ->
    marker = document.createElement("div")
    marker.setAttribute('class', 'custom_marker_content')
    marker.innerHTML = this.args.custom_marker
    { content: marker }

  create_infowindow: ->
    return null unless _.isString @args.custom_infowindow

    boxText = document.createElement("div")
    boxText.setAttribute("class", 'custom_infowindow_content')
    boxText.innerHTML = @args.custom_infowindow
    @infowindow = new InfoBox(@infobox(boxText))

  infobox: (boxText)->
    content: boxText
    pixelOffset: new google.maps.Size(-140, 0)
    boxStyle:
      width: "280px"

handler = Gmaps.build("Google", builders: { Marker: CustomMarkerBuilder } )
handler.buildMap { internal: id: "custom_builder" }, ->
  marker = handler.addMarker
    lat:               40.689167
    lng:               -74.044444
    custom_marker:     "<img src='images/star.jpg' width='30' height='30'> Statue of Liberty"
    custom_infowindow: "<img src='images/statue.jpg' width='90' height='140'> The Statue of Liberty is a colossal neoclassical sculpture on Liberty Island in the middle of New York"

  handler.map.centerOn marker
  handler.getMap().setZoom(15)
-->